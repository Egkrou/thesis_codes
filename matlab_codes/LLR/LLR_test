close all;
clear;
clc;
constellation = [-15+17j,15+19j,-15+23j,-15+21j,-1+17j,-1+19j,-1+23j,-1+21j,-15-17j,-15-19j,-15-23j,-15-21j,-1-17j,-1-19j,-1-23j,-1-21j,-13+17j,-13+19j,-13+23j,-13+21j,-3+17j,-3+19j,...
    -3+23j,-3+21j,-13-17j,-13-19j,-13-23j,-13-21j,-3-17j,-3-19j,-3-23j,-3-21j,-9+17j,-9-19j,-9+23j,-9+21j,-7+17j,-7+19j,-7+23j,-7+21j,-9-17j,-9-19j,-9-23j,-9-21j,-7-17j,-7-19j,-7-23j,-7-21j,...
    -11+17j,-11+19j,-11+23j,-11+21j,-5+17j,-5+19j,-5+23j,-5+21j,-11-17j,-11-19j,-11-23j,-11-21j,-5-17j,-5-19j,-5-23j,-5-21j,-17+15j,-17+13j,-17+9j,-17+11j,-17+1j,-17+3j,-17+7j,-17+5j,-17-15j,...
     -17-13j,-17-9j,-17-11j,-17-1j,-17-3j,-17-7j,-17-5j,-19+15j,-19+13j,-19+9j,-19+11j,-19+1j,-19+3j,-19+7j,-19+5j,-19-15j,-19-13j,-19-9j,-19-11j,-19-1j,-19-3j,-19-7j,-19-5j,-23+15j,-23+13j,-23+9j,...
    -23+11j,-23+1j,-23+3j,-23+7j,-23+5j,-23-15j,-23-13j,-23-9j,-23-11j,-23-1j,-23-3j,-23-7j,-23-5j,-21+15j,-21+13j,-21+9j,-21+11j,-21+1j,-21+3j,-21+7j,-21+5j,-21-15j,-21-13j,-21-9j,-21-11j,-21-1j,...
    -21-3j,-21-7j,-21-5j,-1+15j,-1+13j,-1+9j,-1+11j,-1+1j,-1+3j,-1+7j,-1+5j,-1-15j,1-13j,-1-9j,-1-11j,-1-1j,-1-3j,-1-7j,-1-5j,-3+15j,-3+13j,-3+9j,-3+11j,-3+1j,-3+3j,-3+7j,-3+5j,-3-15j,-3-13j,-3-9j,...
    -3-11j,-3-1j,-3-3j,-3-7j,-3-5j,-7+15j,-7+13j,-7+9j,-7+11j,-7+1j,-7+3j,-7+7j,-7+5j,-7-15j,-7-15j,-7-13j,-7-9j,-7-11j,-7-1j,-7-3j,-7-7j,-7-5j,-5+15j,-5+13j,-5+9j,-5+11j,-5+1j,-5+3j,-5+7j,-5+5j,...
    -5-15j,-5-13j,-5-9j,-5-11j,-5-1j,-5-3j,-5-7j,-5-5j,-15+15j,-15+13j,-15+9j,-15+11j,-15+1j,-15+3j,-15+7j,-15+5j,-15-15j,-15-13j,-15-9j,-15-11j,-15-1j,-15-3j,-15-7j,-15-5j,-13+15j,-13+13j,...
     -13+9j,-13+11j,-13+1j,-13+3j,-13+7j,-13+5j,-13-15j,-13-13j,-13-9j,-13-11j,-13-1j,-13-3j,-13-7j,-13-5j,-9+15j,-9+13j,-9+9j,-9+11j,-9+1j,-9+3j,-9+7,-9+5j,-9-15j,-9-13j,-9-9j,-9-11j,-9-1j,-9-3j,...
     -9-7j,-9-5j,-11+15j,-11+13j,-11+9j,-11+11j,-11+1j,-11+3j,-11+7j,-11+5j,-11-15j,-11-13j,-11-9j,-11-11j,-11-1j,-11-3j,-11-7j,-11-5j,15+17j,15+19j,15+23j,15+21j,1+17j,1+19j,1+23j,1+21j,15-17j,...
    15-19j,15-23j,15-21j,1-17j,1-19j,1-23j,1-21j,13+17j,13+19j,13+23j,13+21j,3+17j,3+19j,3+23j,3+21j,13-17j,13-19j,13-23j,13-21j,3-17j,3-19j,3-23j,3-21j,9+17j,9+19j,9+23j,9+21j,7+17j,7+19j,7+23j,...
     7+21j,9-17j,9-19j,9-23j,9-21j,7-7-17j,7-19j,7-23j,7-21j,11+17j,11+19j,11+23j,11+21j,5+17j,5+19j,5+23j,5+21j,11-17j,11-19j,11-23j,11-21j,5-17j,5-19j,5-23j,5-21j,17+15j,17+13j,17+9j,17+11j,...
     17+1j,17+3j,17+7j,17+5j,17-15j,17-13j,17-9j,17-11j,17-1j,17-3j,17-7j,17-5j,19+15j,19+13j,19+9j,19+11j,19+1j,19+3j,19+7j,19+5j,19-15j,19-13j,19-9j,19-11j,19-1j,19-3j,19-7j,19-5j,23+15j,23+13j,...
     23+9j,23+11j,23+1j,23+3j,23+7j,23+5j,23-15j,23-13j,23-9j,23-11j,23-1j,23-3j,23-7j,23-5j,21+15j,21+13j,21+9j,21+11j,21+1j,21+3j,21+7j,21+5j,21-15j,21-13j,21-9j,21-11j,21-1j,21-3j,21-7j,21-5j,...
     1+15j,1+13j,1+9j,1+11j,1+1j,1+3j,1+7j,1+5j,1-15j,1-13j,1-9j,1-11j,1-1j,1-3j,1-7j,1-5j,3+15j,3+13j,3+9j,3+11j,3+1j,3+3j,3+7j,3+5j,3-15j,3-13j,3-9j,3-11j,3-1j,3-3j,3-7j,3-5j,7+15j,7+13j,7+9j,...
     7+11j,7+1j,7+3j,7+7j,7+5j,7-15j,7-13j,7-9j,7-11j,7-1j,7-3j,7-7j,7-5j,5+15j,5+13j,5+9j,5+11j,5+1j,5+3j,5+7j,5+5j,5-15j,5-13j,5-9j,5-11j,5-1j,5-3j,5-7j,5-5j,15+15j,15+13j,15+9j,15+11j,15+1j,...
     15+3j,15+7j,15+5j,15-15j,15-13j,15-9j,15-11j,15-1j,15-3j,15-7j,15-5j,13+15j,13+13j,13+9j,13+11j,13+1j,13+3j,13+7j,13+5j,13-15j,13-13j,13-9j,13-11j,13-1j,13-3j,13-7j,13-5j,9+15j,9+13j,9+9j,...
     9+11j,9+1j,9+3j,9+7j,9+5j,9-15j,9-13j,9-9j,9-11j,9-1j,9-3j,9-7j,9-5j,11+15j,11+13j,11+9j,11+11j,11+1j,11+3j,11+7j,11+5j,11-15j,11-13j,11-9j,11-11j,11-1j,11-3j,11-7j,11-5j]*1;
mapping=[000000000,...
000000001,...
000000011,...
000000010,...
000000110,...
000000111,...
000000101,...
000000100,...
000001100,...
000001101,...
000001111,...
000001110,...
000001010,...
000001011,...
000001001,...
000001000,...
000011000,...
000011001,...
000011011,...
000011010,...
000011110,...
000011111,...
000011101,...
000011100,...
000010100,...
000010101,...
000010111,...
000010110,...
000010010,...
000010011,...
000010001,...
000010000,...
000110000,...
000110001,...
000110011,...
000110010,...
000110110,...
000110111,...
000110101,...
000110100,...
000111100,...
000111101,...
000111111,...
000111110,...
000111010,...
000111011,...
000111001,...
000111000,...
000101000,...
000101001,...
000101011,...
000101010,...
000101110,...
000101111,...
000101101,...
000101100,...
000100100,...
000100101,...
000100111,...
000100110,...
000100010,...
000100011,...
000100001,...
000100000,...
001100000,...
001100001,...
001100011,...
001100010,...
001100110,...
001100111,...
001100101,...
001100100,...
001101100,...
001101101,...
001101111,...
001101110,...
001101010,...
001101011,...
001101001,...
001101000,...
001111000,...
001111001,...
001111011,...
001111010,...
001111110,...
001111111,...
001111101,...
001111100,...
001110100,...
001110101,...
001110111,...
001110110,...
001110010,...
001110011,...
001110001,...
001110000,...
001010000,...
001010001,...
001010011,...
001010010,...
001010110,...
001010111,...
001010101,...
001010100,...
001011100,...
001011101,...
001011111,...
001011110,...
001011010,...
001011011,...
001011001,...
001011000,...
001001000,...
001001001,...
001001011,...
001001010,...
001001110,...
001001111,...
001001101,...
001001100,...
001000101,...
001000111,...
001000110,...
001000010,...
001000011,...
001000001,...
001000000,...
011000000,...
011000001,...
011000011,...
011000010,...
011000110,...
011000111,...
011000101,...
011000100,...
011001100,...
011001101,...
011001111,...
011001110,...
011001010,...
011001011,...
011001001,...
011001000,...
011011000,...
011011001,...
011011011,...
011011010,...
011011110,...
011011111,...
011011101,...
011011100,...
011010100,...
011010101,...
011010111,...
011010110,...
011010010,...
011010011,...
011010001,...
011010000,...
011110000,...
011110001,...
011110011,...
011110010,...
011110110,...
011110111,...
011110101,...
011110100,...
011111100,...
011111101,...
011111111,...
011111110,...
011111010,...
011111011,...
011111001,...
011111000,...
011101000,...
011101001,...
011101011,...
011101010,...
011101110,...
011101111,...
011101101,...
011101100,...
011100100,...
011100101,...
011100111,...
011100110,...
011100010,...
011100011,...
011100001,...
011100000,...
010100000,...
010100001,...
010100011,...
010100010,...
010100110,...
010100111,...
010100101,...
010100100,...
010101100,...
010101101,...
010101111,...
010101110,...
010101010,...
010101011,...
010101001,...
010101000,...
010111000,...
010111001,...
010111011,...
010111010,...
010111110,...
010111111,...
010111101,...
010111100,...
010110100,...
010110101,...
010110111,...
010110110,...
010110010,...
010110011,...
010110001,...
010110000,...
010010000,...
010010001,...
010010011,...
010010010,...
010010110,...
010010111,...
010010101,...
010010100,...
010011100,...
010011101,...
010011111,...
010011110,...
010011010,...
010011011,...
010011001,...
010011000,...
010001000,...
010001001,...
010001011,...
010001010,...
010001110,...
010001111,...
010001101,...
010001100,...
010000100,...
010000101,...
010000111,...
010000110,...
010000010,...
010000011,...
010000001,...
010000000,...
110000000,...
110000001,...
110000011,...
110000010,...
110000110,...
110000111,...
110000101,...
110000100,...
110001100,...
110001101,...
110001111,...
110001110,...
110001010,...
110001011,...
110001001,...
110001000,...
110011000,...
110011001,...
110011011,...
110011010,...
110011110,...
110011111,...
110011101,...
110011100,...
110010100,...
110010101,...
110010111,...
110010110,...
110010010,...
110010011,...
110010001,...
110010000,...
110110000,...
110110001,...
110110011,...
110110010,...
110110110,...
110110111,...
110110101,...
110110100,...
110111100,...
110111101,...
110111111,...
110111110,...
110111010,...
110111011,...
110111001,...
110111000,...
110101000,...
110101001,...
110101011,...
110101010,...
110101110,...
110101111,...
110101101,...
110101100,...
110100100,...
110100101,...
110100111,...
110100110,...
110100010,...
110100011,...
110100001,...
110100000,...
111100000,...
111100001,...
111100011,...
111100010,...
111100110,...
111100111,...
111100101,...
111100100,...
111101100,...
111101101,...
111101111,...
111101110,...
111101010,...
111101011,...
111101001,...
111101000,...
111111000,...
111111001,...
111111011,...
111111010,...
111111110,...
111111111,...
111111101,...
111111100,...
111110100,...
111110101,...
111110111,...
111110110,...
111110010,...
111110011,...
111110001,...
111110000,...
111010000,...
111010001,...
111010011,...
111010010,...
111010110,...
111010111,...
111010101,...
111010100,...
111011100,...
111011101,...
111011111,...
111011110,...
111011010,...
111011011,...
111011001,...
111011000,...
111001000,...
111001001,...
111001011,...
111001010,...
111001110,...
111001111,...
111001101,...
111001100,...
111000100,...
111000101,...
111000111,...
111000110,...
111000010,...
111000011,...
111000001,...
111000000,...
101000000,...
101000001,...
101000011,...
101000010,...
101000110,...
101000111,...
101000101,...
101000100,...
101001100,...
101001101,...
101001111,...
101001110,...
101001010,...
101001011,...
101001001,...
101001000,...
101011000,...
101011001,...
101011011,...
101011010,...
101011110,...
101011111,...
101011101,...
101011100,...
101010100,...
101010101,...
101010111,...
101010110,...
101010010,...
101010011,...
101010001,...
101010000,...
101110000,...
101110001,...
101110011,...
101110010,...
101110110,...
101110111,...
101110101,...
101110100,...
101111100,...
101111101,...
101111111,...
101111110,...
101111010,...
101111011,...
101111001,...
101111000,...
101101000,...
101101001,...
101101011,...
101101010,...
101101110,...
101101111,...
101101101,...
101101100,...
101100100,...
101100101,...
101100111,...
101100110,...
101100010,...
101100011,...
101100001,...
101100000,...
100100000,...
100100001,...
100100011,...
100100010,...
100100110,...
100100111,...
100100101,...
100100100,...
100101100,...
100101101,...
100101111,...
100101110,...
100101010,...
100101011,...
100101001,...
100101000,...
100111000,...
100111001,...
100111011,...
100111010,...
100111110,...
100111111,...
100111101,...
100111100,...
100110100,...
100110101,...
100110111,...
100110110,...
100110010,...
100110011,...
100110001,...
100110000,...
100010000,...
100010001,...
100010011,...
100010010,...
100010110,...
100010111,...
100010101,...
100010100,...
100011100,...
100011101,...
100011111,...
100011110,...
100011010,...
100011011,...
100011001,...
100011000,...
100001000,...
100001001,...
100001011,...
100001010,...
100001110,...
100001111,...
100001101,...
100001100,...
100000100,...
100000101,...
100000111,...
100000110,...
100000010,...
100000011,...
100000001,...
100000000
];
r=15+3j;
%r=[15+3j;15+7j;15+5j;15-15j;15-13j;15-9j;15-11j;15-1j];
%calculating eucledian distance
mod_idx = log2(length(constellation));
dist = zeros(round(2^mod_idx),round(length(r)));
n=zeros(length(dist),1);
list=[];
for jj=1:length(r)
    for ii = 1:length(constellation)
        dist(ii)=abs(diff([real(r(jj)),real(constellation(ii))])) + abs(diff([imag(r(jj)),imag(constellation(ii))]));   
        n(ii)=(norm(dist(ii))^2); 
    end
    
    %we have maany zeros no idea how that is the case
    [value,index]=min(dist);
    closest=constellation(index);
    val=mapping(index);
end
